"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};exports.default={props:{createModifiers:Object,editModifiers:Object,viewModifiers:Object,createSlots:Array,editSlots:Array,viewSlots:Array},computed:{modifiers:function(){return"edit"===this.formType?this.editModifiers:"add"===this.formType?this.createModifiers:"view"===this.formType?this.viewModifiers:void 0},customSlots:function(){return"edit"===this.formType?this.editSlots:"add"===this.formType?this.createSlots:"view"===this.formType?this.viewSlots:void 0}},data:function(){return{serverDefinition:{},fieldSet:{}}},methods:{createRocketFormDefinition:function(e){this.serverDefinition=e;var t=!0,i=!1,r=void 0;try{for(var o,s=this.serverDefinition.fields[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var a=o.value;this.fieldSet[a.fieldId]=a}}catch(e){i=!0,r=e}finally{try{!t&&s.return&&s.return()}finally{if(i)throw r}}var l=0;this.createCustomSlots(this.definition);var n=!0,d=!1,f=void 0;try{for(var u,c=(this.serverDefinition.groups||[])[Symbol.iterator]();!(n=(u=c.next()).done);n=!0){var p=u.value;if("object"===(void 0===p?"undefined":_typeof(p))){var y={type:"section",title:p.label,instructions:p.description,inputs:[]};this.processGroupModifiers(y,p.groupId);var v=!0,h=!1,m=void 0;try{for(var S,b=p.fields[Symbol.iterator]();!(v=(S=b.next()).done);v=!0){var g=S.value,T=this.fieldSet[g];y.inputs.push(this.createRocketFieldDefinition(T,l)),l++,this.createCustomSlots(y.inputs,g)}}catch(e){h=!0,m=e}finally{try{!v&&b.return&&b.return()}finally{if(h)throw m}}this.definition.push(y),this.createCustomSlots(this.definition,p.groupId)}else{var x=this.fieldSet[p];this.definition.push(this.createRocketFieldDefinition(x,l)),l++,this.createCustomSlots(this.definition,x.fieldId)}}}catch(e){d=!0,f=e}finally{try{!n&&c.return&&c.return()}finally{if(d)throw f}}},createCustomSlots:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.customSlots){var i=!0,r=!1,o=void 0;try{for(var s,a=this.customSlots[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var l=s.value;l.after===t&&e.push({type:"scoped-slot",name:l.name})}}catch(e){r=!0,o=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}}},processGroupModifiers:function(e,t){if(this.modifiers&&this.modifiers[t]){var i=Object.assign({},this.modifiers[t]);delete i.type,delete i.inputs,e=Object.assign(e,i)}},createRocketFieldDefinition:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i={type:this.getFieldDataType(e),name:e.fieldId,label:e.label,validation:this.getValidation(e),options:{}};if(0===t&&(i.options.autofocus=!0),"select"===e.dataType)this.createSelect(i,e);else if("enum"===e.dataType)i.idcol=e.valueIdFieldName,i.valuecol=e.valueDescriptorFieldName,i.items=e.values;else if("multiselect"===e.dataType)this.createMultiSelect(i,e);else if("files"===e.dataType||"file"===e.dataType||"images"===e.dataType||"image"===e.dataType)i.url=this.url,e.orderPivotField&&(i.options["re-order"]=!0);else if("longtext"===e.dataType)i.options={multiline:!0};else if("boolean"===e.dataType){var r=!0,o=!1,s=void 0;try{for(var a,l=e.values[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var n=a.value;0===n.id?i.options.falseDisplayValue=n.text:1===n.id&&(i.options.trueDisplayValue=n.text)}}catch(e){o=!0,s=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw s}}}else"richtext"===e.dataType?i.options={}:"datetime"===e.dataType?(i.dateLabel=e.dateLabel,i.timeLabel=e.timeLabel):"location"===e.dataType?e.centerLat&&e.centerLng&&(i.options={center:{lat:e.centerLat,lng:e.centerLng}}):"currency"===e.dataType&&(i.options={prefix:e.currencySymbol});return this.processFieldModifiers(i,e.fieldId),i},createSelect:function(e,t){e.idcol=t.valueIdFieldName,e.valuecol=t.valueDescriptorFieldName,e.items=t.values},createMultiSelect:function(e,t){e.idcol=t.valueIdFieldName,e.valuecol=t.valueDescriptorFieldName,e.items=t.values},processFieldModifiers:function(e,t){if(this.modifiers&&this.modifiers[t]){var i=Object.assign({},this.modifiers[t]);i.options&&(e.options=Object.assign(e.options,i.options),delete i.options),e=Object.assign(e,i)}},getFieldDataType:function(e){var t=e.dataType;return"select"===t?"single-option":"multiselect"===t?"multi-option":"longtext"===t?"text":"int"===t||"decimal"===t||"currency"===t?"text":t},getValidation:function(e){var t=[],i=!0,r=!1,o=void 0;try{for(var s,a=e.validators[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var l=s.value;"rf_server"===l.rule||"rf_server_express"===l.rule?t.push(l.rule+":"+e.fieldId):t.push(l.rule)}}catch(e){r=!0,o=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return e.isOptional||t.push("required"),t.join("|")}}};